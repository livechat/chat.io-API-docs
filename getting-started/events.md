---
title: "Events"
weight: 20
---

# Events


### Introduction

Events are portions of data which can be sent to a chat ([send_event](../../agent-api/client-server#send-event)). There are different types of events:

 - [message](#message)
 - [annotation](#annotation)
 - [filled-form](#filled-form)
 - [system message](#system-message)
 - [file](#file)
 - [custom event](#custom-event)


[Incoming event](../../agent-api/server-client#incoming-event) push will inform you about events sent to a chat (on both, agent and customer side).


### Common event fields

All events have some common fields, we will describe them here to avoid duplication:

| name        | puprose                                        | filled by | type   |
|-------------|------------------------------------------------|-----------|--------|
| `id`        | id of the event                                | server    | string |
| `custom_id` | is an ID that you can set for your own purpose | client    | string |
| `order`     | event with lower `order` are hronologicaly before | server | int    |
| `author_id` | this is id of sender of the event              | server    | string |
| `text`      | this is payload that you can send whithin event (for example message content) | client | string |
| `recipients` | posibble values are `"all"`(default) and `"agents"` | client | string |
| `properties` | event properties, more about this in future properties section | client | properties object |


### Message

Message is the most common and self-explanatory event type. It allows sending some text to other chat users. The data format looks like this:

```js
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743",  // generated by server side
  "custom_id": "12345-bhdsa",
  "order": 1,  // generated by server side
  "type": "message",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "timestamp": 1473433500,  // generated by server side
  "text": "hello there",
  "recipients": "all",
  "properties": {
    // "Properties" object
  }
}
```


### Annotation

Adds annotation to last thread. It is important to mention that sending annotation cannot start a new thread (even if there is no active thread in a chat), it always goes to latest thread that alredy exist.

```js
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743", // generated by server side
  "custom_id": "12312.301231238591134",
  "order": 1, // generated by server side
  "type": "annotation",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "timestamp": 1473433500, // generated by server side
  "text": "Example annotation",
  "annotation_type": "rating",
  "properties": {
    // "Properties" object
  }
}
```

`annotation_type` - type of the annotation. This field cannot be empty and is customizable, you can have your own annotation types (i.e. we use "rating" type)


### Filled form

Filled form is event containing some data from form. Here's what it looks like:

```js
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743", // generated by server side
  "custom_id": "12312.301231238591134",
  "order": 4, // generated by server side
  "type": "filled_form",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "timestamp": 1473433500,  // generated by server side
  "properties": {
    // "Properties" object
  }
  "fields": [
    // "Field" objects
  ]
}
```

There are 5 different types of field from filled form, all of these types can be mixed together in one filled form event.

`text`:

```js
  {
    "type": "text",
    "name": "name",
    "label": "Your name",
    "required": true,
    "value": "Jan Kowalski"
  }
```

`email`:

```js
  {
    "type": "email",
    "name": "email",
    "label": "Your email",
    "required": true,
    "value": "jan.kowalski@gmail.com"
  }
```

`radio`:

```js
  {
    "type": "radio",
    "name": "purpose",
    "label": "Chat purpose",
    "required": true,
    "options": [{
      "label": "Support",
      "value": "support",
      "checked": true
    },
    {
      "label": "Sale",
      "value": "sale",
      "checked": false
    }],
  }
```

`checkbox`:

```js
  {
    "type": "checkbox",
    "name": "industry",
    "label": "Company industry",
    "required": true,
    "options": [{
      "label": "automotive",
      "value": "automotive",
      "checked": true
    }, {
      "label": "IT",
      "value": "it",
      "checked": true
    }],
  }
```

`select`:

```js
{
  "type": "select",
  "name": "country",
  "label": "Country",
  "required": true,
  "options": [{
    "label": "USA",
    "value": "usa",
    "checked": false
  }, {
    "label": "Poland",
    "value": "pl",
    "checked": true
  }, {
    "label": "Poland",
    "value": "pl",
    "checked": false
  }]
}
```


### System message

System message is event generated by server. It does not have "author_id", "custom_id" and "properties" fields.

```js
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743",
  "order": 1,
  "type": "system_message",
  "timestamp": 1473433500,
  "text": "Mike joined the chat",
  "system_message_type": "agent_joined"
}
```

System messages can be triggered by an user action within chat or by router (more about router messages in future Router section). Each action triggers system message with different `system_message_type` and has different `text` message:

| system_message_type | text                             |
|---------------------|----------------------------------|
| `agent_joined`      | `<agent_name> joined the chat`   |
| `agent_left`        | `<agent_name> left the chat`     |
| `manual_archived`   | `<agent_name> archived the chat` |


### File

File event indicates that a file was uploaded. It can be only generated by server when [send file](../../customer-api/client-server#send-file) customer API method is called.

```js
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743",
  "custom_id": "12312.301231238591134",
  "order": 1,
  "type": "file",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "timestamp": 1473433500,
  "properties": {
    // "Properties" object
  }
  "name": "image25.png",
  "url": "https://domain.com/asdsfdsf.png",
  "content_type": "image/png",
  "size": 123444,
  "width": 640,
  "height": 480
}
```

The `size` field means file size in bytes. It is limited to 10 MB. <br>
The `content-type` field can contain any [MIME media type](https://en.wikipedia.org/wiki/Media_type). <br>
Fields `width` and `height` are present only for `"image/png"`, `"image/gif"` and `"image/jpg"` content-types. There is no limitations for width and height.


### Custom event

Custom event is event that has 100% custom payload. You can send any json within it.

```js
{
  "id": "0affb00a-82d6-4e07-ae61-56ba5c36f743",
  "custom_id": "12312.301231238591134",
  "order": 1,
  "type": "custom",
  "author_id": "b7eff798-f8df-4364-8059-649c35c9ed0c",
  "timestamp": 1473433500,
  "content": {
    //any json object
  },
  "properties": {
    // "Properties" object
  }
}
```